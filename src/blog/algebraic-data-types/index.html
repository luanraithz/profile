
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="Description" content="Luan Raithz's website">
  <title>Tipos de Dados Alg√©bricos</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;1,300;1,700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="/assets/favicon.ico"/>
  <style>:root {
  --header-height: 300px;
  --theme-color: #567dbc;
  --text-color: #c0c0c0;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body, html, #app {
  background-color: #262626;
  font-family: 'Roboto', sans-serif;
  padding:0;
  margin:0;
  height: 100%;
}

@media screen and (max-width: 500px) {
  :root {
    --header-height: 200px;
  }
}
a {
  padding: 0.3em 0.5rem;
  color: var(--text-color);
  font-weight: 500;
  font-size: 1rem;
  text-decoration: none;
}
a:active, a:link, a:visited {
  color: var(--text-color);
  text-decoration: none;
  outline: none;
}
a:hover {
  color: var(--theme-color);
  cursor: pointer;
}
.blog-content {
  padding: 1em;
}
.blog-content * {
  font-size: 25px;
}
.blog-content .title {
  margin-top: 15px;
  font-size: 55px;
  text-align: center;
} 

.blog-content .link {
  font-size: 20px;
}
.blog-content div h2 {
  color: var(--theme-color);
  font-size: 35px;
}
.blog-content div b {
  color: var(--theme-color);
}
.blog-content .date {
  font-size: 20px;
  color: var(--theme-color);
  text-align: center;
  margin-bottom: 35px;

} 
.blog-content div p {
  margin-bottom: 15px;

}
.with-theme-color {
  color: var(--theme-color);
}

.last-posts-menu {
  margin: 15px 0;
}</style>
</head>

<body>
  <div id="app">
  <div class="blog-content">
	<a href="/" class="link"> Back to home </a>
  	<h1 class="title">Tipos de Dados Alg√©bricos</h1>
	  <h2 class="date">December - 2019</h2>
	  <div>
	  <main>
	  	<article>
  		<h3 id="do-or-do-not-there-is-no-try">&quot;Do or do not there is no try&quot;</h3>
<blockquote>
<p>Os exemplos de c√≥digo s√£o em Java e OCaml, n√£o √© necess√°rio saber nenhum dos dois pra entender o que foi feito.</p>
</blockquote>
<p>Em linguagens como OCaml, Haskell e StandardML, conceitos como algebraic data types s√£o a principal forma de representar dados e flow de execu√ß√£o de um programa. Nesse post eu vou tentar demonstrar como esse tipo de vis√£o pode ajudar em qualquer linguagem no controle de erros e resultados de chamadas de fun√ß√µes, tanto imperativas (que envolvem IO, ou alteracoes no estado da aplica√ß√£o) como puras.  </p>
<h2 id="o-conceito">O conceito</h2>
<p>Criar um novo tipo a partir da composi√ß√£o de outros.</p>
<p>Onde a composi√ß√£o pode ser feita por uma soma (<code>sum</code>) ou por um produto (<code>product</code>) de tipos.</p>
<h3 id="sum-types">Sum types</h3>
<pre><code class="language-ocaml">type carbrand = audi | volkswagen
</code></pre>
<blockquote>
<p>Uma vari√°vel do tipo <code>carbrand</code> √© <code>audi</code> ou <code>volkswagen</code></p>
</blockquote>
<p>Sum type pode ser entendi como <code>ou</code>.</p>
<h3 id="product-types">Product types</h3>
<pre><code class="language-ocaml">type name = string
type age = int
type person = name * age
</code></pre>
<p>&quot;Uma pessoa √© composta por um nome(name) <strong>e</strong> uma idade(age)&quot;</p>
<p>Diferentemente do tipo anterior (sum), esse tipo √© entendido como um <strong><code>e</code></strong>.</p>
<h2 id="aplica√ß√£o">Aplica√ß√£o</h2>
<p>Ap√≥s essa r√°pida introdu√ß√£o conceitual, j√° se torna v√°lido mostrar a aplicabilidade em controle de fluxo da aplica√ß√£o e valida√ß√£o de erros.</p>
<p>Em linguagens orientadas a objeto (aqui usado Java), o meio mais comum de controlar &quot;erros&quot; s√£o <code>exceptions</code>.</p>
<p>Com o tempo <code>exceptions</code> come√ßaram a ser usadas at√© em casos de uma simples valida√ß√£o.</p>
<p>Exemplo:</p>
<pre><code class="language-java">public String saveUser(User us) {
    try {
        service.save(us);
        return &quot;Saved!&quot;;
    } catch (InvalidAgeException _) {
        return &quot;Invalid age&quot;;
    }
}
</code></pre>
<p>Aqui chegamos no primeiro ponto do texto. <code>NO EXCEPTIONS</code>.</p>
<p><a href="https://www.atlassian.com/blog/archives/exceptions_are_bad">Exceptions deveriam ser realmente EXCEPTIONS</a>.
Usar exceptions para casos como valida√ß√£o de dados subverte at√© seu nome, no exemplo acima uma valida√ß√£o de idade de uma pessoa √© tratado como exception, por√©m isso √© muito mais uma regra de neg√≥cio.</p>
<p>Uma perda de conex√£o com o banco de dados seria uma exception, ou como o post linkado d√° o exemplo, algu√©m removeu o HD da m√°quina.</p>
<p>Utilizando maneiras mais funcionais de controle de erros, ganhamos formas de controle de execu√ß√£o como <a href="https://vimeo.com/97344498"><code>Railway</code></a> e uma documenta√ß√£o viva de todos os erros e resultados da aplica√ß√£o, se todos os erros que uma fun√ß√£o pode retornar est√£o no seu tipo de retorno, quem chama a fun√ß√£o precisa tratar todos eles. Uma parte das vantagens citadas tamb√©m pode ser alcan√ßada por meio de <code>exceptions</code>, mas nos for√ßa a pensar na execu√ß√£o de uma fun√ß√£o de uma maneira diferente, onde come√ßamos a ver fluxos desej√°veis (valida√ß√µes, etc) da mesma forma que vemos cen√°rios como <code>&quot;a m√°quina ficou sem rede no meio da requesi√ß√£o&quot;</code>. <code>Exceptions</code> ainda v√£o acontecer, mas queremos deixar o uso dela para casos realmente excepcionais.</p>
<p>Esse tipo de <code>approach</code> demonstra a fraqueza do sistema de tipos da linguagem, por n√£o deixar o programador expressar erros de uma maneira menos &quot;barulhenta&quot;.</p>
<p>Com os artificios que mostramos anteriormente (expecificamente <code>sum types</code>), o c√≥digo poderia ficar parecido com (OCaml):</p>
<pre><code class="language-ocaml">let saveUser u =
    let res = (save u) in
        match res with
        | InvalidAge -&gt; &quot;Invalid age&quot;
        | Success -&gt; &quot;Saved!&quot;
</code></pre>
<blockquote>
<p>Nesse c√≥digo, fazemos uso de uma funcionalidade muito explorada em programa√ß√£o funcional, onde escolhemos uma a√ß√£o baseada no tipo de dado que estamos trabalhando com (aka <a href="https://wiki.c2.com/?PatternMatching">pattern matching</a>).</p>
</blockquote>
<h3 id="separa√ß√£o-de-dom√≠nios-e-controle-de-erros-e-valida√ß√µes">Separa√ß√£o de dom√≠nios e controle de erros e valida√ß√µes</h3>
<p>Com a expressividade desse sistema de tipos a separa√ß√£o de camadas da aplica√ß√£o fica muito mais clara.</p>
<p>Onde <code>union types</code> (ou algebraic data types no geral) s√£o usados, temos os seguintes pontos a ganhar:</p>
<ul>
<li>Documenta√ß√£o viva das fun√ß√µes, tendo que exceptions (de verdade) e erros de valida√ß√£o est√£o separados.</li>
<li>Garantia de que, se for adicionado mais algum caso de erro, todos os lugares que fazem uso dessa fun√ß√£o precisam tratar ou pelo menos ignorar explicitamente.<blockquote>
<p>A necessidade disso pode variar de projeto pra projeto, existem casos aonde o programador n√£o quer tratar todos os retornos e erros, apenas um ou outro, logo fica explicito no c√≥digo que os mesmo est√£o sendo ignorados. <code>Vai do programador escolher (everthing is a trade-off)</code>.</p>
</blockquote>
</li>
<li>Separa√ß√£o de responsabilidade e tipos de retorno.<blockquote>
<p>Como mostrado no exemplo anterior, a fun√ß√£o de <code>save</code> n√£o porta nenhum detalhe sobre mensagens ou status codes, apenas sabe o que produz, tanto os erros como resultados de sucesso, n√£o existe nela nenhuma ideia de que seu resultado vai ser aplicado.</p>
</blockquote>
</li>
</ul>
<h2 id="refer√™ncias">Refer√™ncias</h2>
<ul>
<li><a href="https://www.atlassian.com/blog/archives/exceptions_are_bad">Exceptions are Bad‚Ñ¢</a><blockquote>
<p>O autor desse artigo d√° a sugest√£o de usar <code>Maybe</code> ou <code>Either</code>, ambos s√£o tipos de dados alg√©bricos üòâ</p>
</blockquote>
</li>
<li><a href="https://jrsinclair.com/articles/2019/algebraic-data-types-what-i-wish-someone-had-explained-about-functional-programming/">Algebraic Data Types: Things I wish someone had explained about functional programming</a></li>
<li><a href="https://itnext.io/an-introduction-to-algebraic-data-types-9429e49eac27">An Introduction to Algebraic Data Types</a><blockquote>
<p>O post acima tem exemplos usando Typescript</p>
</blockquote>
</li>
<li><a href="https://vimeo.com/97344498">Talk: Railway oriented programming (usando F#)</a></li>
</ul>

	  	</article>
	  </main>
	  </div>
  </div>
  </div>
</body>

</html>
